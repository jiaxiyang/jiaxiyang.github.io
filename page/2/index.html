<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0-rc2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jiaxiyang.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="深度学习&#x2F;自动驾驶&#x2F;C++&#x2F;性能优化">
<meta property="og:type" content="website">
<meta property="og:title" content="Xiyang">
<meta property="og:url" content="https://jiaxiyang.github.io/page/2/index.html">
<meta property="og:site_name" content="Xiyang">
<meta property="og:description" content="深度学习&#x2F;自动驾驶&#x2F;C++&#x2F;性能优化">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="贾夕阳">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jiaxiyang.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Xiyang</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WGS6S6YFJ6"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-WGS6S6YFJ6');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Xiyang</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Think twice, code once!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">147</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">37</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">47</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/jiaxiyang" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2021/09/30/Amazing-emacs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/30/Amazing-emacs/" class="post-title-link" itemprop="url">Amazing emacs</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-30 09:48:34" itemprop="dateCreated datePublished" datetime="2021-09-30T09:48:34+08:00">2021-09-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-24 12:15:25" itemprop="dateModified" datetime="2023-09-24T12:15:25+08:00">2023-09-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/Emacs/" itemprop="url" rel="index"><span itemprop="name">Emacs</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/09/30/Amazing-emacs/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/09/30/Amazing-emacs/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Emacs-Architecture"><a href="#Emacs-Architecture" class="headerlink" title="Emacs Architecture"></a>Emacs Architecture</h2><p><img src="https://pic2.zhimg.com/964f7a10ac8a4158896500858efb4a55_b.png" alt="Emacs Architecture 《架构之美》"></p>
<h2 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h2><ol>
<li><code>ln -s build-debug/compile_commands.json</code> 设置软连接</li>
<li><code>lsp</code>提示时按 i, 否则不能补全</li>
<li><code>list-face-display and list-colors-display</code> 列出颜色</li>
<li><code>(add-hook &#39;window-setup-hook &#39;on-after-init)</code> 启动时防止 buffer 模糊不通透</li>
</ol>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/09/30/Amazing-emacs/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2021/07/11/Rust-grammar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/11/Rust-grammar/" class="post-title-link" itemprop="url">Rust grammar</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-11 18:34:03" itemprop="dateCreated datePublished" datetime="2021-07-11T18:34:03+08:00">2021-07-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-24 12:15:43" itemprop="dateModified" datetime="2023-09-24T12:15:43+08:00">2023-09-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Program/Rust/" itemprop="url" rel="index"><span itemprop="name">Rust</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/07/11/Rust-grammar/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/07/11/Rust-grammar/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>19k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>18 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="顶层概念"><a href="#顶层概念" class="headerlink" title="顶层概念"></a><a target="_blank" rel="noopener" href="https://www.infoq.cn/article/Uugi_eIJusEka1aSPmQM">顶层概念</a></h2><p><img src="https://static001.infoq.cn/resource/image/2d/91/2d36b45f6905a13a310e6447778ca391.jpg" alt="概念层次图"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/07/11/Rust-grammar/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2020/08/11/OS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/11/OS/" class="post-title-link" itemprop="url">OS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-11 12:10:18" itemprop="dateCreated datePublished" datetime="2020-08-11T12:10:18+08:00">2020-08-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-20 15:37:37" itemprop="dateModified" datetime="2023-06-20T15:37:37+08:00">2023-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer/" itemprop="url" rel="index"><span itemprop="name">Computer</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/08/11/OS/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/08/11/OS/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="page-faults"><a href="#page-faults" class="headerlink" title="page faults"></a>page faults</h2><ol>
<li></li>
</ol>
<h2 id="C-变量内存分配区域"><a href="#C-变量内存分配区域" class="headerlink" title="C++ 变量内存分配区域"></a>C++ 变量内存分配区域</h2><ol>
<li>栈区（stack） 由编译器自动分配释放 ，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈。</li>
<li>堆区（heap）就是那些由 malloc 等分配的内存块，他和堆是十分相似的，不过它是用 free 来结束自己的生命的。一般由程序员分配释放， 若程序员不释放，程序结束时可能由 OS 回收 。注意它与数据结构中的堆是两回事，分配方式倒是类似于链。堆可以动态地扩展和收缩。</li>
<li>自由存储区(也在堆区？) 就是那些由 new 分配的内存块，一般一个 new 就要对应一个 delete。</li>
<li>全局区&#x2F;静态区（static）全局变量和静态变量的存储是放在一块的，初始化的全局变量和静态变量在一块区域 data 段， 未初始化的全局变量和未初始化的静态变量在相邻的另一块区域 bss 段。程序结束后有系统释放</li>
<li>常量存储区 存放的是常量，不允许修改。常量字符串就是放在这里的。常量字符串不能修改, 否则程序会在运行期崩溃（当然，你要通过非正当手段也可以修改，而且方法很多）.程序结束后由系统释放</li>
</ol>
<h3 id="C-自由存储区和堆区"><a href="#C-自由存储区和堆区" class="headerlink" title="C++ 自由存储区和堆区"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/Q_1849805767/article/details/107376682">C++ 自由存储区和堆区</a></h3><ol>
<li>堆是操作系统维护的一块内存，而自由存储是 C++中通过 new 与 delete 动态分配和释放对象的抽象概念。堆与自由存储区并不等价</li>
<li>new &#x2F; new[]：完成两件事，先底层调用 malloc 分配了内存，然后调用构造函数（创建对象）。</li>
<li>delete&#x2F;delete[]：也完成两件事，先调用析构函数（清理资源），然后底层调用 free 释放空间。</li>
<li>new 在申请内存时会自动计算所需字节数，而 malloc 则需我们自己输入申请内存空间的字节数。</li>
</ol>
<h2 id="linux-虚拟内存空间分区"><a href="#linux-虚拟内存空间分区" class="headerlink" title="linux 虚拟内存空间分区"></a>linux 虚拟内存空间分区</h2><ol>
<li><code>cat /proc/pid/maps 或 pmap pid</code> 看进程映射区域</li>
<li>64 位系统虚拟内存 <img src="https://fanlv.wiki/2021/07/25/linux-mem/Linux-Memory-X86-64.jpg" alt="linux 64 memory"></li>
<li>ELF 在装载时按照 Segment 划分。一个 Segment 包含一个或多个属性类型的 Section。实际上 Segment 的概念是从装载的角度重新定划分了 ELF 的各个段。<a target="_blank" rel="noopener" href="https://maodanp.github.io/2019/06/02/linux-virtual-space/">link</a>， 映射的时候，这里面的 segment 会对应一个 VMA。Linux 将进程虚拟地址空间中的一个段叫做虚拟内存区域（VMA）。<img src="https://maodanp.github.io/pic/2019/2019-06-02-linux-virtual-space-02.png" alt="示意图"></li>
<li>ELF 可执行文件中有两个概念，分别是段(segment)和节(section)。通过 <code>readelf -S name.elf</code> 可以查看 ELF 可执行文件的节头表，这里面有所有节的信息。使用命令 <code>readelf -l name.elf</code> 来查看 ELF 的段。而系统正是按照“segment”而不是“section”来映射可执行文件的。</li>
<li>readelf -a test 先显示 section 信息， 然后显示 segment(Program Headers)信息，接着显示 Section to Segment mapping 信息</li>
<li>从装载的角度看，我们只关心”LOAD”型的 segment，因为只有它是需要被映射的，其他诸如“NOTE”,”GNU_STACK”都是在装载时起辅助作用的。<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44395686/article/details/104761488">link</a></li>
<li>总体而言，Segment 和 Section 是从不同角度来划分同一个 ELF 文件。从 Section 角度来看 ELF 文件就是链接视图（Linking View），从 Segment 角度来看 ELF 文件则是执行视图（Execution View）。</li>
</ol>
<h3 id="进程虚拟存储器"><a href="#进程虚拟存储器" class="headerlink" title="进程虚拟存储器"></a>进程虚拟存储器</h3><ol>
<li>只读区(.init, .text, .rodata)</li>
<li>已初始化的数据(.data 段)</li>
<li>未初始化的数据(.bss 段)</li>
<li>堆</li>
<li>映射区(mmap, 共享库等)</li>
<li>栈</li>
</ol>
<h3 id="内核虚拟存储器"><a href="#内核虚拟存储器" class="headerlink" title="内核虚拟存储器"></a>内核虚拟存储器</h3><ol>
<li>内核代码和数据</li>
<li>物理存储器</li>
<li>与进程相关的数据结构(每个进程不同)</li>
</ol>
<h2 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h2><ol>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/16557699">变量根据情况分配在.bss 段上</a><ul>
<li>int bigvar_in_bss[16300];</li>
<li>int bigvar_in_bss[16300] &#x3D; {0};</li>
<li>int bigvar_in_data[16300] &#x3D; {1};</li>
<li>int var_in_data[5] &#x3D; {1, 2, 3, 4, 5};</li>
</ul>
</li>
<li><code>file -A</code> 查看各 section 大小</li>
<li><code>nm test</code> 查看变量是否在 bss 段上</li>
<li><code>readelf -s test 或 nm -S test</code> 查看变量大小, 在其他模块定义的符号 size 为 0</li>
<li><code>nm -S --size-sort test</code> 按 size 排序</li>
<li>初始化为 0 的在 bss 段上？<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/16557776">link</a></li>
</ol>
<h2 id="others"><a href="#others" class="headerlink" title="others"></a>others</h2><h3 id="同步异步，阻塞非阻塞区别"><a href="#同步异步，阻塞非阻塞区别" class="headerlink" title="同步异步，阻塞非阻塞区别"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mhq-martin/p/9035640.html">同步异步，阻塞非阻塞区别</a></h3><ol>
<li><p><code>不同的的概念，同步与异步区别是什么时候拿到最终结果，阻塞和非阻塞区别进程线程是是否等待结果， 同步可以是阻塞的， 也可以是非阻塞的(一次非阻塞拿不全结果， 轮询try_lock或read noblock)，异步可以是阻塞的，也可以是非阻塞的，阻塞是同步的，但非阻塞不一定异步的. 比如非阻塞系统调用read，返回的是字节数，不是最终结果。</code></p>
</li>
<li><p>组合：</p>
<ul>
<li>同步阻塞：同步接口里使用阻塞方式拿到最终结果</li>
<li>同步非阻塞：同步接口里通过非阻塞方式轮询拿到最终结果</li>
<li>异步阻塞：异步接口里通过阻塞方式拿到最终结果</li>
<li>异步非阻塞：异步接口里通过非阻塞方式拿到最终结果</li>
</ul>
</li>
<li><p>同步与异步是更高层次上的概念</p>
</li>
<li><p>同步与异步区别是什么时候拿到最终结果。如果是在调用函数就拿到最终结果，则是同步的，</p>
</li>
<li><p>同步异步区别是在调用一个功能时，没得到<code>结果</code>之前，是否继续后续操作（有问题，非阻塞也是没拿到结果，也往后继续进行， 但是非阻塞不一定是异步的）</p>
</li>
<li><p>阻塞非阻塞区别是<code>线程/程序</code>在等待调用结果时，是否一直等待（挂起当前线程）</p>
</li>
<li><p>阻塞和非阻塞关注的是程序在<code>等待调用结果</code>（消息，返回值）时的<code>状态</code>.</p>
</li>
<li><p>进程线程锁是用来同步的，lock()函数是阻塞式，不拿到锁不返回，线程被阻塞。try_lock()是非阻塞式的，如果拿不到锁也返回。</p>
</li>
<li><p>异步是目的，而多线程是实现这个目的的方法</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/19732473/answer/241673170">非阻塞 I&#x2F;O 和异步 I&#x2F;O</a><br>非阻塞 I&#x2F;O 系统调用( nonblocking system call )的另一个替代品是 异步 I&#x2F;O 系统调用 （asychronous system call）。 与非阻塞 I&#x2F;O 系统调用类似，asychronous system call 也是会立即返回， 不会等待 I&#x2F;O 操作的完成， 应用程序可以继续执行其他的操作， 等到 I&#x2F;O 操作完成了以后，操作系统会通知调用进程（设置一个用户空间特殊的变量值 或者 触发一个 signal 或者 产生一个软中断 或者 调用应用程序的回调函数）。<br>此处， 非阻塞 I&#x2F;O 系统调用( nonblocking system call ) 和 异步 I&#x2F;O 系统调用 （asychronous system call）的区别是：</p>
<ul>
<li>一个非阻塞 I&#x2F;O 系统调用 read() 操作立即返回的是任何可以立即拿到的数据， 可以是完整的结果， 也可以是不完整的结果， 还可以是一个空值。</li>
<li>而异步 I&#x2F;O 系统调用 read（）结果必须是完整的， 但是这个操作完成的通知可以延迟到将来的一个时间点。<br>上面提到的 非阻塞 I&#x2F;O 系统调用( nonblocking system call ) 和 异步 I&#x2F;O 系统调用 都是非阻塞式的行为（non-blocking behavior）。 他们的差异仅仅是返回结果的方式和内容不同。</li>
</ul>
</li>
<li><p>我们所说的 “阻塞”是指进程在发起了一个系统调用（System Call） 后， 由于该系统调用的操作不能立即完成，需要等待一段时间，于是内核将进程挂起为等待 （waiting）状态， 以确保它不会被调度执行， 占用 CPU 资源。</p>
</li>
<li><p>在进程通信层面， 阻塞&#x2F;非阻塞， 同步&#x2F;异步基本是同义词， 但是需要注意区分讨论的对象是发送方还是接收方。发送方阻塞&#x2F;非阻塞（同步&#x2F;异步）和接收方的阻塞&#x2F;非阻塞（同步&#x2F;异步） 是互不影响的。</p>
</li>
<li><p>在 IO 系统调用层面（ IO system call ）层面， 非阻塞 IO 系统调用 和 异步 IO 系统调用存在着一定的差别， 它们都不会阻塞进程， 但是返回结果的方式和内容有所差别， 但是都属于非阻塞系统调用（ non-blocing system call ）</p>
</li>
<li><p>举例：从磁盘读 50000 字节到内存</p>
</li>
</ol>
<ul>
<li>同步：调用 api，api 内不拿到结果或出错不返回。</li>
<li>异步：调用 api, 直接返回，结果通过 callback 等方式通知。结果是完整的。</li>
<li>阻塞：线程系统调用 read(), 不读 50000 字节不返回，线程挂起，内核态在执行。</li>
<li>非阻塞：线程系统调用 read(NO_BLOCK), 达到某个条件，如出现’\n’直接返回，结果不完整，线程要多次调用来得到结果。</li>
</ul>
<h3 id="Linux-异步-I-O-框架-io-uring：基本原理、程序示例与性能压测"><a href="#Linux-异步-I-O-框架-io-uring：基本原理、程序示例与性能压测" class="headerlink" title="Linux 异步 I&#x2F;O 框架 io_uring：基本原理、程序示例与性能压测"></a><a target="_blank" rel="noopener" href="http://arthurchiao.art/blog/intro-to-io-uring-zh/">Linux 异步 I&#x2F;O 框架 io_uring：基本原理、程序示例与性能压测</a></h3><h2 id="CFS"><a href="#CFS" class="headerlink" title="CFS"></a>CFS</h2><ol>
<li><a target="_blank" rel="noopener" href="http://arthurchiao.art/blog/linux-cfs-design-and-implementation-zh/">Linux CFS 调度器：原理、设计与内核实现</a></li>
</ol>
<h2 id="linux-src"><a href="#linux-src" class="headerlink" title="linux src"></a>linux src</h2><ol>
<li><a target="_blank" rel="noopener" href="https://askubuntu.com/a/159842">apt-get source linux-source</a></li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2020/11/28/Shell-script/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/28/Shell-script/" class="post-title-link" itemprop="url">Shell Script</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-28 10:38:00" itemprop="dateCreated datePublished" datetime="2020-11-28T10:38:00+08:00">2020-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-20 15:37:37" itemprop="dateModified" datetime="2023-06-20T15:37:37+08:00">2023-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Program/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/11/28/Shell-script/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/11/28/Shell-script/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h2><ol>
<li>判断 linux 命令是否存在</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BUILD_SYSTEM=Ninja</span><br><span class="line">if ! [ -x &quot;$(command -v ninja)&quot; ]; then</span><br><span class="line">    BUILD_SYSTEM=&#x27;Unix Makefiles&#x27;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if ! command -v &lt;the_command&gt; &amp;&gt; /dev/null</span><br><span class="line">then</span><br><span class="line">    echo &quot;&lt;the_command&gt; could not be found&quot;</span><br><span class="line">    exit</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<ol>
<li>分支，循环、 case， 函数、正则表达式</li>
<li>shell 风格指南 <a target="_blank" rel="noopener" href="https://zh-google-styleguide.readthedocs.io/en/latest/google-shell-styleguide/contents/">link</a></li>
<li>seq 产生顺序数 for i in <code>seq 1 10</code>;do echo jia; sleep 1; done</li>
<li>cat</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>  &gt;&gt; a.txt &lt;&lt;<span class="string">EOF        追加</span></span><br><span class="line"><span class="string">    hello,world</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>  &gt; a.txt &lt;&lt;<span class="string">EOF      覆盖</span></span><br><span class="line"><span class="string">    hello,world</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<ol>
<li>set -xe 显示运行的每一条命令，出错退出。 -x 显示 -e 退出</li>
<li>echo -e “jiaxiyang\c” 脚本输出不换行</li>
<li>16 进制转化为 10 进制 num&#x3D;”ABCD1234” &amp;&amp; echo $((16#${num}))</li>
<li>产生随机数 cat &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;uuid</li>
<li>获取本机 IP 地址： ifconfig | grep “inet addr:” | awk ‘{ print $2 }’| sed ‘s&#x2F;addr:&#x2F;&#x2F;g’</li>
<li>awk 按列过滤参数 ls -l test.sh | awk ‘{ print $5 }’ 输出：454</li>
<li>shell 小程序<a target="_blank" rel="noopener" href="https://www.jb51.net/article/54488.htm">link</a></li>
<li>shell 得到文件信息 <code>ll /var/log/messages | cut -d &quot; &quot; -f 5</code></li>
<li>shell 不用输入密码登录 expect <a target="_blank" rel="noopener" href="http://www.cnblogs.com/lixigang/articles/4849527.html">link</a> set timeout 3 ; spawn ssh <a href="mailto:&#x6a;&#x69;&#97;&#x78;&#x69;&#121;&#x61;&#x6e;&#103;&#x40;&#x31;&#48;&#x2e;&#x31;&#48;&#46;&#48;&#46;&#49;&#x37;">&#x6a;&#x69;&#97;&#x78;&#x69;&#121;&#x61;&#x6e;&#103;&#x40;&#x31;&#48;&#x2e;&#x31;&#48;&#46;&#48;&#46;&#49;&#x37;</a>; expect “*password:”; send “jiaxiyang\r”;interact</li>
<li>读文件内容，记录到变量中 var&#x3D;$(cat name.txt)</li>
<li>计时 start&#x3D;$(date+%s) &amp;&amp; sleep 2 &amp;&amp; end&#x3D;$(date+%s)&amp;&amp; echo $(($end - $start)) <a target="_blank" rel="noopener" href="http://blog.csdn.net/gengshenghong/article/details/7583580">link</a></li>
<li>sleep: sleep 1 睡眠 1 秒 sleep 1s 睡眠 1 秒 sleep 1m 睡眠 1 分 sleep 1h 睡眠 1 小时</li>
<li>[ -f test ] &amp;&amp; rm test 如果存在 test 文件 删除 test ，逻辑运算代替 if<br>对于包含至少一个其他函数的足够长的脚本，需要称为  main  的函数。main “$@”</li>
<li>比较二进制文件</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">process</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    file=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;file  : <span class="subst">$(realpath $&#123;file&#125;)</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;date  : <span class="subst">$(date -r $&#123;file&#125;)</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;length: <span class="subst">$(wc -c $&#123;file&#125; | awk &#x27;&#123;print $1&#125;&#x27;)</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;md5sum: <span class="subst">$(md5sum $(realpath $&#123;file&#125;)</span> | awk &#x27;&#123;print <span class="variable">$1</span>&#125;&#x27;)&quot;</span></span><br><span class="line">    xxd -l 96 <span class="variable">$&#123;file&#125;</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;date now: <span class="subst">$(date)</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> <span class="variable">$@</span>; <span class="keyword">do</span></span><br><span class="line">    process <span class="variable">$var</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ol>
<li>function(in .bashrc)</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">loop</span></span> ()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">eval</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">sleep</span> 1; <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">eval</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span>;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>copy link libs</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">libs() &#123;</span><br><span class="line">    OUTPUT_DIR=$(date -u +&quot;%Y-%m-%d-%H:%M:%S&quot;)</span><br><span class="line">    mkdir -p $&#123;OUTPUT_DIR&#125;/bin $&#123;OUTPUT_DIR&#125;/lib</span><br><span class="line">    BINS=&quot;$@&quot;</span><br><span class="line">    cp $&#123;BINS&#125; $&#123;OUTPUT_DIR&#125;/bin/</span><br><span class="line">    &quot;$(ldd $&#123;BINS&#125; | grep &quot;=&gt; /&quot; | awk &#x27;&#123;print $3&#125;&#x27; | xargs -I &#x27;&#123;&#125;&#x27; cp -v &#x27;&#123;&#125;&#x27; $&#123;OUTPUT_DIR&#125;/lib)&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>创建固定个数 panel，每个 panel 执行不同命令</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PANEL_NUM=6</span><br><span class="line">while [ $(tmux list-panes | wc -l) -lt $&#123;PANEL_NUM&#125; ]; do</span><br><span class="line">	tmux split-window \; #select-pane -L</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">even-horizontal even-vertical main-horizontal main-vertical tiled</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tmux select-layout even-horizontal</span></span><br><span class="line">tmux select-layout tiled</span><br><span class="line"></span><br><span class="line">CURRENT_PANEL=$(tmux display -pt &quot;$&#123;TMUX_PANE:?&#125;&quot; &#x27;#&#123;pane_index&#125;&#x27;)</span><br><span class="line">for i in $(seq 1 $&#123;PANEL_NUM&#125;); do</span><br><span class="line">	echo $&#123;i&#125;</span><br><span class="line">	if [ $&#123;i&#125; -ne $&#123;CURRENT_PANEL&#125; ]; then</span><br><span class="line">		tmux send-keys -t .$&#123;i&#125; &quot;echo $&#123;i&#125;; ls -al&quot; c-m</span><br><span class="line">	fi</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li>删除和添加版权信息</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># remove license</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> i <span class="keyword">in</span> $(/usr/bin/fdfind -e h -e cpp -e hpp -e cc); <span class="keyword">do</span></span></span><br><span class="line">for i in $(find . -regex &#x27;.*\.\(cpp\|cc\|cxx\|hpp\|h\)&#x27;); do</span><br><span class="line">	line=$(cat $i | grep -n &quot;#i[fn]\|#pragma&quot; | awk -F &#x27;:&#x27; &#x27;&#123;print $1&#125;&#x27; | awk &#x27;NR==1&#x27;)</span><br><span class="line">	line=$(($&#123;line&#125; - 1))</span><br><span class="line">	if (($&#123;line&#125; &gt; 0)); then</span><br><span class="line">		sed -i &quot;1, $&#123;line&#125;d&quot; $i</span><br><span class="line">	fi</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># add license</span></span></span><br><span class="line">cat &gt;pgcopyright.txt &lt;&lt;EOF</span><br><span class="line">/**</span><br><span class="line"> * @copyright PhiGent.ai @ 2022</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">for i in $(find . -regex &#x27;.*\.\(cpp\|cc\|cxx\|hpp\|h\)&#x27;); do</span><br><span class="line">	cat pgcopyright.txt $i &gt;$i.new &amp;&amp; mv $i.new $i</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">rm pgcopyright.txt</span><br></pre></td></tr></table></figure>

<ol>
<li>push to jfrog</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">JFROG_USER=xiyang.jia</span><br><span class="line">JFROG_PASSWD=</span><br><span class="line"></span><br><span class="line">push_to_jfrog() &#123;</span><br><span class="line">        FILE=$1</span><br><span class="line">        JFROG_PATH=http://artifacts.phigent.io/artifactory/$2</span><br><span class="line">        MD5=$(md5sum $FILE | awk &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line">        curl -u&quot;$&#123;JFROG_USER&#125;:$&#123;JFROG_PASSWD&#125;&quot; -T $FILE -H &quot;X-Checksum-MD5:$&#123;MD5&#125;&quot; -L &quot;$&#123;JFROG_PATH&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">push_dir_to_jfrog()&#123;</span><br><span class="line">        for file in $(find $1 -type f); do</span><br><span class="line">                push_to_jfrog $&#123;file&#125; $2/$&#123;file&#125;</span><br><span class="line">        done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if [ -d $1 ]; then</span><br><span class="line">        push_dir_to_jfrog $1 $2</span><br><span class="line">else</span><br><span class="line">        push_to_jfrog $1 $2</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2022/03/03/UML/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/03/UML/" class="post-title-link" itemprop="url">UML</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-03 02:32:22" itemprop="dateCreated datePublished" datetime="2022-03-03T02:32:22+08:00">2022-03-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-20 15:37:37" itemprop="dateModified" datetime="2023-06-20T15:37:37+08:00">2023-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/03/03/UML/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/03/03/UML/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="UML-介绍"><a href="#UML-介绍" class="headerlink" title="UML 介绍"></a>UML 介绍</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.visual-paradigm.com/cn/guide/uml-unified-modeling-language/what-is-uml/">历史</a></li>
<li>图表可大致分为结构性图表和行为性图表两种。结构性图表显示了系统在不同抽象层次和实现层次上的静态结构以及它们之间的相互关系。结构性图表中的元素表示系统中具意义的概念，可能包括抽象的、现实的和實作的概念。</li>
<li>结构性图表有七种类型：<ul>
<li>类图 (Class Diagram)</li>
<li>组件图 (Component Diagram)</li>
<li>部署图 (Deployment Diagram)</li>
<li>对象图 (Object Diagram)-</li>
<li>包图 (Package Diagram)</li>
<li>复合结构图 (Composite Structure Diagram)</li>
<li>轮廓图 (Profile Diagram)</li>
</ul>
</li>
<li>行为性图表显示了系统中对象的动态行为 ，可用以表达系统随时间的变化。行为性图表有七种类型：<ul>
<li>用例图 (Use Case Diagram)</li>
<li>活动图 (Activity Diagram)</li>
<li>状态机图 (State Machine Diagram)</li>
<li>序列图 (Sequence Diagram)</li>
<li>通訊圖 (Communication Diagram)</li>
<li>交互概述图 (Interaction Overview Diagram)</li>
<li>时间图 (Timing Diagram)</li>
</ul>
</li>
</ol>
<h2 id="图种类"><a href="#图种类" class="headerlink" title="图种类"></a>图种类</h2><ol>
<li>class diagram 类图</li>
<li>sequence diagram 时序图</li>
<li>flow chart 流程图</li>
</ol>
<h3 id="class-diagram"><a href="#class-diagram" class="headerlink" title="class diagram"></a>class diagram</h3><h3 id="sequence-diagram"><a href="#sequence-diagram" class="headerlink" title="sequence diagram"></a><a target="_blank" rel="noopener" href="https://www.woshipm.com/ucd/607593.html">sequence diagram</a></h3><h4 id="关系"><a href="#关系" class="headerlink" title="关系"></a>关系</h4><p><img src="https://pica.zhimg.com/v2-941a070601f399d992125ef31261637e_1440w.jpg?source=172ae18b" alt="关系"></p>
<!-- prettier-ignore -->
<table>
<thead>
<tr>
<th align="left">名字</th>
<th align="left">图形</th>
<th align="left">说明</th>
<th align="left">其他</th>
</tr>
</thead>
<tbody><tr>
<td align="left">实现关系</td>
<td align="left">空心三角和虚线组成的箭头</td>
<td align="left">实现类指向接口</td>
<td align="left">类似 rust trait</td>
</tr>
<tr>
<td align="left">泛化关系</td>
<td align="left">空心三角和实线组成的箭头</td>
<td align="left">从子类指向父类</td>
<td align="left">“is a”</td>
</tr>
<tr>
<td align="left">关联关系</td>
<td align="left">带箭头的实线</td>
<td align="left">指向被关联的对象</td>
<td align="left">一个对象含有另一个对象的引用</td>
</tr>
<tr>
<td align="left">依赖关系</td>
<td align="left">带虚线的箭头</td>
<td align="left">使用方指向被使用方</td>
<td align="left">“use a”, 弱关联关系,<br>构造器或方法中的局部变量、方法或构造器的参数、方法的返回值</td>
</tr>
<tr>
<td align="left">聚合关系</td>
<td align="left">空心菱形加实线箭头</td>
<td align="left">空心菱形在整体一方，箭头指向部分一方</td>
<td align="left">“has a”, 具有各自的生命周期</td>
</tr>
<tr>
<td align="left">组合关系</td>
<td align="left">实心菱形加实线箭头</td>
<td align="left">实心菱形在整体一方，箭头指向部分一方</td>
<td align="left">“contains a” 强聚合, 作为整体的对象负责部分的对象的生命周期</td>
</tr>
</tbody></table>
<!-- prettier-ignore -->
<h2 id="mermaid"><a href="#mermaid" class="headerlink" title="mermaid"></a>mermaid</h2><p>1.## <a target="_blank" rel="noopener" href="https://github.com/mermaid-js/mermaid">mermaid</a></p>
<ol>
<li><a target="_blank" rel="noopener" href="https://mermaid.live/">在线 server</a></li>
<li><a target="_blank" rel="noopener" href="https://jojozhuang.github.io/tutorial/mermaid-cheat-sheet/">cheat sheet</a></li>
<li>markdown 支持</li>
<li>theme <code>%%&#123;init: &#123;&#39;theme&#39;: &#39;base&#39;, &#39;themeVariables&#39;: &#123; &#39;primaryColor&#39;: &#39;#ffcccc&#39;, &#39;edgeLabelBackground&#39;:&#39;#ffffee&#39;, &#39;tertiaryColor&#39;: &#39;#fff0f0&#39;, &#39;fontFamily&#39;: &#39;verdana&#39;&#125;&#125;&#125;%%</code></li>
<li><a target="_blank" rel="noopener" href="https://mermaid-js.github.io/mermaid/#/theming">theming</a></li>
<li>可以用 graph 画关系图<a target="_blank" rel="noopener" href="https://github.com/bitcoin/bitcoin/blob/master/doc/design/libraries.md#L36">bitcoin sample</a></li>
<li>gatte 图也好用</li>
<li>github 用 chrome 插件<a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/markdown-diagrams/pmoglnmodacnbbofbgcagndelmgaclel">markdown-diagrams</a>可以生成图片, 密集图片截屏效果不好</li>
<li><code>%%&#123;init: &#123;&#39;securityLevel&#39;: &#39;loose&#39;, &#39;theme&#39;:&#39;base&#39;&#125;&#125;%%</code> 设置主题</li>
<li><code>%%&#123;init:&#123;&quot;themeVariables&quot;: &#123; &quot;fontSize&quot;: &quot;30px&quot; &#125;&#125;&#125;%%</code> 设置字体大小</li>
<li><code>%%&#123;init:&#123;&#39;theme&#39;:&#39;neutral&#39;, &quot;themeVariables&quot;: &#123; &quot;fontSize&quot;: &quot;20px&quot; &#125;&#125;&#125;%%</code></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mermaid-js/mermaid/issues/3033">字体设置只支持几种图，其他不支持</a></li>
<li>flow chart 支持 <a target="_blank" rel="noopener" href="https://fontawesome.com/icons">fontawesome</a></li>
</ol>
<pre class="mermaid">classDiagram
    user ..> image
    image ..> MediaProc
    MediaProc <|-- ImgProcImpl
    ImgProcImpl ..> ImageFrame : 代理
    ImageFrame <|-- ImageFrameImpl
    ImageFrameImpl <|-- BpuImageFrame

    class MediaProc{
      <<interface>>
      +Crop()
      +Resize()
      +CvtColor()
      +Decode()
      +Encode()
    }

    class ImgProcImpl{
      +Crop()
      +Resize()
      +CvtColor()
      +Decode()
      +Encode()
    }

    class ImageFrame{
      <<interface>>
      +Crop()
      +Resize()
      +CvtColor()
    }

    class ImageFrameImpl{
      +Crop()
      +Resize()
      +CvtColor()
    }

    class BpuImageFrame{
      +Crop()
      +Resize()
      +CvtColor()
    }</pre>

<ol>
<li>samples<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/tiangolo/fastapi/blob/master/docs/en/docs/tutorial/dependencies/dependencies-with-yield.md#dependencies-with-yield-and-httpexception">fastapi</a></li>
<li><a target="_blank" rel="noopener" href="https://mermaid.live/edit#pako:eNqdVFFr01AU_iuX-6QYW9vabuvDQLoNYVKGKYIaH26Tk-ZCkhtvbqe1FMQndZsOhogwNycMBWHTFwU39M_YrG_-BW9605rNZk7zkNDvnPud85379XSxySzAVRzC3Tb4JsxR0uLEM3wkn4BwQU0aEF-gmkvBF3_iOvBl4ArnYArEW81zxXJZQ8VScfg6r4J1JgBx2nIEYnZCV0X9w4f9dyuoUVtC0fOd6MmKSlbhi7Ozir6q36yrADEFXSaSKd2PSpLZCavMvnCltnjiRLpTCyYSnSw7Jknlp2nAt04ql6Jj9X_TLQUrvUcHG9Hr7Z-Hq_311ejlZzWP_sHXow8rjWv64PtW9Gx3cnMJgK6C67J_mE4CqHMaqoG8TJua8piWhBahM3_fdIjfGkPD5DnmQwbn_8AZlzBx0hnij3VaG35rNHCA6wGYGlqgPg0dsDI4ToUzrvxsIz5eOEPoZPck_5tyOe0fF-yhfUYtSmsg5Q1lldg_Q-dELz5Ga3s_Dt8Mvm1kyJur6yja3h3svx3sf4k-PTpF18Ta0eZa_-lO_9V7RZLL5TKG8LtQbPKtzbMNY1iTxQZVYW1Ut7-3Gj1eT7EavjoxerCGPeAeoZZcaN04ZmDhgAcGlpeKbcYhFAbWUpEbhFPSdCGMU7qKLs70xQLxqNuJ4dujKgZuUA9CVId76DrziJ9wqZjO2twceoXaaIkzA6vYHS1Nq9MHSTuFQiBUTs_we7J30hZM7_gmrgreBg23A0sOKVnIuGoTNxyj8xYVjI9BlxEL5M8uFp0gXuctGgpJaTLfpq0Yb3NXwo4QQVjN5-NwrkWF027mTOblQ2o5cqc7yzOVfKVYmSbFElSmSqRcKllmszAzbRcvF2xr6lKhSHCvp2G5-m8xNuqq9ws-JjhZ">三次握手 config 中有中文支持</a></li>
</ul>
</li>
</ol>
<h2 id="plantuml"><a href="#plantuml" class="headerlink" title="plantuml"></a><a target="_blank" rel="noopener" href="https://github.com/plantuml/plantuml">plantuml</a></h2><ol>
<li><p><a target="_blank" rel="noopener" href="http://www.plantuml.com/plantuml/uml/">在线 server</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/plantuml/plantuml-server">本地 plantuml-server</a></p>
<ul>
<li><code>docker run -d -p 10093:8080 plantuml/plantuml-server:jetty</code></li>
<li><code>docker run -d -p 10093:8080 -e THE_ENV_VARIABLE=THE_ENV_VALUE plantuml/plantuml-server:jetty</code></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://plantuml.com/zh/guide">pdf guide</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://plantuml.com/zh/class-diagram">class</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://plantuml.com/zh/sequence-diagram">时序图</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/iluwatar/java-design-patterns">java-design-patterns</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/iluwatar/java-design-patterns/blob/master/factory-method/etc/factory-method.urm.puml">puml config file demo</a></p>
</li>
<li><p>markdown gitlab github 不支持， 用<a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/markdown-diagrams/pmoglnmodacnbbofbgcagndelmgaclel">markdown-diagrams</a>来支持浏览器显示</p>
</li>
<li><p>test plantuml</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line">object Object01</span><br><span class="line">object Object02</span><br><span class="line">object Object03</span><br><span class="line">object Object04</span><br><span class="line">object Object05</span><br><span class="line">object Object06</span><br><span class="line">object Object07</span><br><span class="line">object Object08</span><br><span class="line"></span><br><span class="line">Object01 &lt;|-- Object02</span><br><span class="line">Object03 *-- Object04</span><br><span class="line">Object05 o-- &quot;4&quot; Object06</span><br><span class="line">Object07 .. Object08 : some labels</span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure>

<h2 id="dot-language"><a href="#dot-language" class="headerlink" title="dot language"></a><a target="_blank" rel="noopener" href="https://graphviz.org/doc/info/lang.html">dot language</a></h2><ol>
<li><a target="_blank" rel="noopener" href="https://gitlab.com/graphviz/graphviz/-/tree/main/cmd/dot">dot 命令源码</a></li>
<li><code>sudo apt-get install graphviz</code></li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/DOT%E8%AF%AD%E8%A8%80">维基介绍</a></li>
<li><a target="_blank" rel="noopener" href="https://itopic.org/graphviz.html">属性</a></li>
<li><a target="_blank" rel="noopener" href="http://www.graphviz.org/gallery/">samples</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zywvvd.com/notes/tools/graphviz/graphviz/">Graphviz 使用教程</a></li>
<li>sample</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">digraph test123 &#123;</span><br><span class="line">        pack=8</span><br><span class="line">        subgraph cluster0 &#123;</span><br><span class="line">          packmode=array</span><br><span class="line">          x y x0 y0 x1</span><br><span class="line">          subgraph cluster1 &#123;</span><br><span class="line">            m n</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        b [shape=box];</span><br><span class="line">        c [label=&quot;helloenworld&quot;,color=blue,fontsize=24,</span><br><span class="line">             fontname=&quot;Palatino-Italic&quot;,fontcolor=red,style=filled];</span><br><span class="line">        a -&gt; z</span><br><span class="line">        x -&gt; z</span><br><span class="line">        a -&gt; b -&gt; c;</span><br><span class="line">        a -&gt; &#123;x y&#125;;</span><br><span class="line">        edge [style=dashed,color=red];</span><br><span class="line">        b -&gt; x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="doxygen-生成-UML"><a href="#doxygen-生成-UML" class="headerlink" title="doxygen 生成 UML"></a>doxygen 生成 UML</h2><h2 id="links"><a href="#links" class="headerlink" title="links"></a>links</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shindo/p/5579191.html">关系</a></li>
<li><a target="_blank" rel="noopener" href="https://www.51fusa.com/client/information/informationdetail/id/1561.html">基于 SOME&#x2F;IP 的 AP AUTOSAR 实战</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904039902085134">适合程序员的 UML 绘图工具</a></li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2022/10/18/explore/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/18/explore/" class="post-title-link" itemprop="url">explore</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-18 19:35:20" itemprop="dateCreated datePublished" datetime="2022-10-18T19:35:20+08:00">2022-10-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-12 17:22:56" itemprop="dateModified" datetime="2023-09-12T17:22:56+08:00">2023-09-12</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/10/18/explore/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/10/18/explore/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>201</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="idea"><a href="#idea" class="headerlink" title="idea"></a>idea</h2><ol>
<li>新功能用 sourcegraph 探索大家都怎么使用的， 如探索 mermaid 使用</li>
</ol>
<h2 id="links"><a href="#links" class="headerlink" title="links"></a>links</h2><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/topics/profiling">topics&#x2F;profiling</a></li>
<li><a target="_blank" rel="noopener" href="https://osawards.com/">Open Source Awards</a></li>
<li><a target="_blank" rel="noopener" href="https://osawards.com/javascript/2022">osawards.com&#x2F;javascript</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/search?o=desc&q=stars:%3E0&s=stars&type=Repositories">github star sort</a></li>
<li><a target="_blank" rel="noopener" href="https://opensource.google/projects">opensource.google</a></li>
</ol>
<h2 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.brendangregg.com/overview.html">brendangregg</a></li>
<li><a target="_blank" rel="noopener" href="http://arthurchiao.art/articles-zh/">arthurchiao</a></li>
<li><a target="_blank" rel="noopener" href="https://gaomf.cn/2020/06/03/shared_library_global_symbol_override/">码农半亩地</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/freelancer-leon/notes/tree/master">freelancer-leon&#x2F;notes</a></li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2022/02/15/Gitlab-CI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/15/Gitlab-CI/" class="post-title-link" itemprop="url">Gitlab-CI</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-02-15 23:27:31" itemprop="dateCreated datePublished" datetime="2022-02-15T23:27:31+08:00">2022-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-20 15:37:37" itemprop="dateModified" datetime="2023-06-20T15:37:37+08:00">2023-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/CI/" itemprop="url" rel="index"><span itemprop="name">CI</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/02/15/Gitlab-CI/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/02/15/Gitlab-CI/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="badges"><a href="#badges" class="headerlink" title="badges"></a>badges</h2><ol>
<li>显示 build 状态</li>
<li><a target="_blank" rel="noopener" href="https://www.benjaminrancourt.ca/what-are-gitlab-badges/">what-are-gitlab-badges</a></li>
</ol>
<h2 id="include"><a href="#include" class="headerlink" title="include"></a><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/yaml/#includelocal">include</a></h2><ol>
<li>可以 include local file, private project and remote file。</li>
</ol>
<h2 id="release-artifacts"><a href="#release-artifacts" class="headerlink" title="release artifacts"></a><a target="_blank" rel="noopener" href="https://gitlab.phigent.io/help/user/project/releases/index">release artifacts</a></h2><ol>
<li><a target="_blank" rel="noopener" href="https://crypt.codemancers.com/posts/2021-08-31-release-artifacts-using-gitlab-cicd/#generating-the-artifacts">release-artifacts-using-gitlab-cicd</a></li>
<li><a target="_blank" rel="noopener" href="https://gitlab.phigent.io/help/user/project/releases/index#use-a-generic-package-for-attaching-binaries">gitlab release 和 artifactory 结合</a><ul>
<li>notes: 注意 tag-name， ci 跑完之后会打 tag，然后又会运行 ci, 总共会跑两次</li>
<li>不能缺少 tag-name， 使用 rules: - if: $CI_COMMIT_TAG, 只有打 tag 的时候才运行</li>
<li><a target="_blank" rel="noopener" href="https://kinsta.com/knowledgebase/401-error/">401 error</a></li>
</ul>
</li>
<li>删除 tag 就能删除 release 对应内容</li>
<li>gitlab release comment 支持 markdown 和 mermaid</li>
</ol>
<h2 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h2><ol>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/triggers/">trigger other pipeline</a></li>
<li>前面加 dot，可以隐藏 job <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/jobs/#hide-jobs">link</a></li>
</ol>
<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/ssh_keys/">ssh</a></h2><ol>
<li>区分多种执行方式：<ul>
<li>shell: 需要 runenr</li>
<li>docker: 在 docker 下执行，不需要指定 runner</li>
<li>ssh</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://gitlab.com/gitlab-examples/ssh-private-key/-/blob/master/.gitlab-ci.yml">example</a></li>
<li><a target="_blank" rel="noopener" href="https://gitlab.com/gitlab-examples/ssh-private-key/-/issues/1#note_48526556">ssh-key 要求</a></li>
<li>需要在 deploy 机器上生成 ssh， private key 作为变量传入配置中</li>
<li>shell 需要在 runner 机器上秘钥对，把公钥复制到部署板子上 <code>ssh-copy-id -i ~/.ssh/id_rsa.pub xxx@xxx</code></li>
</ol>
<h2 id="runner"><a href="#runner" class="headerlink" title="runner"></a><a target="_blank" rel="noopener" href="https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section">runner</a></h2><ol>
<li>可以 reset token <a target="_blank" rel="noopener" href="https://docs.gitlab.com/runner/commands/#gitlab-runner-reset-token">link</a></li>
<li>gitlab repo ci 配置可以显示安装 runner 命令</li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/runner/commands/">commands</a></li>
<li><code>gitlab-ci-multi-runner list</code> list runners</li>
<li><code>gitlab-ci-multi-runner status</code></li>
<li><code>/etc/gitlab-runner/</code> 配置路径</li>
<li>注册 project for runner:<ul>
<li><code>gitlab-runner register</code></li>
<li><code>gitlab-runner verify</code> 如果是感叹号执行这条命令</li>
<li><code>gitlab-runner unregister --name test-runner</code> 删除 runner</li>
</ul>
</li>
<li>使用 <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/runners/runners_scope.html">shared runner</a>:<ul>
<li>需要 admin 用户</li>
<li>group 下默认有</li>
</ul>
</li>
<li>Group runners:This project does not belong to a group and cannot make use of group runners. 只需要 group tocken 就好</li>
</ol>
<h2 id="script"><a href="#script" class="headerlink" title="script"></a>script</h2><ol>
<li>所有 job 都执行</li>
</ol>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">default:</span></span><br><span class="line"><span class="symbol">  before_script:</span></span><br><span class="line">    - echo <span class="string">&quot;Execute this script in all jobs that don&#x27;t already have a before_script section.&quot;</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">job1:</span></span><br><span class="line"><span class="symbol">  script:</span></span><br><span class="line">    - echo <span class="string">&quot;This script executes after the global before_script.&quot;</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">job:</span></span><br><span class="line"><span class="symbol">  before_script:</span></span><br><span class="line">    - echo <span class="string">&quot;Execute this script instead of the global before_script.&quot;</span></span><br><span class="line"><span class="symbol">  script:</span></span><br><span class="line">    - echo <span class="string">&quot;This script executes after the job&#x27;s `before_script`&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a>deploy</h2><ol>
<li><code>sshpass -p $PASSWORD scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -r ./build $CUSTOM_USERNAME@$CUSTOM_IP:/var/www/html</code> sshpass 设置 ci 变量</li>
<li><code>sshpass -p $PASSWORD sshpass -p root rsync -avz -e &quot;ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null&quot; -r ./build $CUSTOM_USERNAME@$CUSTOM_IP:/var/www/html</code></li>
</ol>
<h2 id="prefill-variables"><a href="#prefill-variables" class="headerlink" title="prefill variables"></a>prefill variables</h2><ol>
<li><a target="_blank" rel="noopener" href="https://gitlab.com/gitlab-org/gitlab/-/issues/300106">how to use prefill variables</a></li>
<li>两种方式：<ul>
<li>yml 文件中<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">variables:</span></span><br><span class="line"><span class="attr">PASSWORD:</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">  <span class="attr">pdescription:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line"><span class="attr">CUSTOM_USERNAME:</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">&quot;petalinux&quot;</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;username&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>project CI&#x2F;CD variable settings</li>
</ul>
</li>
</ol>
<h2 id="workflow"><a href="#workflow" class="headerlink" title="workflow"></a><a target="_blank" rel="noopener" href="https://docs.gitlab.com/14.8/ee/ci/yaml/workflow.html">workflow</a></h2><h2 id="keys"><a href="#keys" class="headerlink" title="keys"></a>keys</h2><h3 id="needs"><a href="#needs" class="headerlink" title="needs"></a>needs</h3><ol>
<li>可以用来串联 stage</li>
<li>传递 stage 文件需要 <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/yaml/index.html#needsartifacts">link</a></li>
<li>可以看 pipeline efficiency <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/pipelines/pipeline_efficiency.html">link</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/directed_acyclic_graph/">DAG</a></li>
</ol>
<h2 id="rules"><a href="#rules" class="headerlink" title="rules"></a>rules</h2><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/gitlabhq/gitlabhq/blob/2ea638391497c495798e0bab7c704af112789299/.gitlab/ci/rules.gitlab-ci.yml">rules 模板</a></li>
<li>只手动编译， 有个按键可以执行所有 job</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.rules:if-tag-or-manual:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;&lt;:</span> <span class="string">*if-tag</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">when:</span> <span class="string">manual</span></span><br><span class="line"></span><br><span class="line"><span class="string">.rules:always:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">when:</span> <span class="string">always</span></span><br><span class="line">      <span class="attr">allow_failure:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## fix mr detach issue</span></span><br><span class="line"><span class="attr">workflow:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">&#x27;$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot;&#x27;</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">never</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">when:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">build</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Build::GPU_ubuntu20.04:</span></span><br><span class="line">  <span class="attr">extends:</span></span><br><span class="line">    <span class="string">.rules:if-tag-or-manual</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li>在 mr 时自动运行全流程，or 手动选择要编译的平台</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">.if-tag:</span> <span class="string">&amp;if-tag</span></span><br><span class="line">  <span class="attr">if:</span> <span class="string">&#x27;$CI_COMMIT_TAG&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.if-merge-request:</span> <span class="string">&amp;if-merge-request</span></span><br><span class="line">  <span class="attr">if:</span> <span class="string">$CI_PIPELINE_SOURCE</span> <span class="string">==</span> <span class="string">&quot;merge_request_event&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.if-tag-or-mr:</span> <span class="string">&amp;if-tag-or-mr</span></span><br><span class="line">  <span class="attr">if:</span> <span class="string">&#x27;$CI_COMMIT_TAG&#x27;</span></span><br><span class="line">  <span class="attr">if:</span> <span class="string">$CI_PIPELINE_SOURCE</span> <span class="string">==</span> <span class="string">&quot;merge_request_event&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.rules:if-tag-or-mr-or-manual:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;&lt;:</span> <span class="string">*if-tag-or-mr</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">when:</span> <span class="string">manual</span></span><br><span class="line"></span><br><span class="line"><span class="string">.rules:always:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">when:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">build</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Build::GPU_ubuntu20.04:</span></span><br><span class="line">  <span class="attr">extends:</span></span><br><span class="line">    <span class="string">.rules:if-tag-or-mr-or-manual</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Build::Vitis:</span></span><br><span class="line">  <span class="attr">extends:</span></span><br><span class="line">    <span class="string">.rules:if-tag-or-mr-or-manual</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/yaml/#workflowrules">workflowrules 控制整个 pipeline</a></li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflow:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_COMMIT_TITLE</span> <span class="string">=~</span> <span class="string">/-draft$/</span></span><br><span class="line">      <span class="attr">when:</span> <span class="string">never</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_PIPELINE_SOURCE</span> <span class="string">==</span> <span class="string">&quot;merge_request_event&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">$CI_DEFAULT_BRANCH</span></span><br></pre></td></tr></table></figure>

<ol>
<li>when, can only be always or never when used with workflow. 不能 when: manual, 不支持</li>
<li>可以设置一个伪 job， manual 触发，后续 job 依赖伪 job</li>
<li>完善解决方案： 使用 <a target="_blank" rel="noopener" href="https://github.com/GNOME/gnome-shell/blob/4bbf6d497d34793693e5ac24fbe23854b481002b/.gitlab-ci.yml#L41">temlate</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/jobs/job_control.html#avoid-duplicate-pipelines">avoid-duplicate-pipelines</a></li>
</ol>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rules:</span><br><span class="line">   - <span class="keyword">if</span>: &#x27;<span class="built_in">$CI</span>_PIPELINE_SOURCE == <span class="string">&quot;merge_request_event&quot;</span>&#x27;</span><br></pre></td></tr></table></figure>

<ol>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/jobs/job_control.html#reuse-rules-in-different-jobs">default-rules(&gt;&#x3D;14.3)</a></li>
</ol>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><ol>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/yaml/script.html#split-long-commands">split-long-commands</a></li>
<li>gtest 结果 xml 可以显示到 ci pipeline 结果中去 <a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/unit_test_reports.html">link</a></li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cpp:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./gtxxx</span> <span class="string">--gtest_output=xml:report.xml</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">artifacts:</span></span><br><span class="line">    <span class="attr">when:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">reports:</span></span><br><span class="line">      <span class="attr">junit:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">report.xml</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">fail.xml</span></span><br></pre></td></tr></table></figure>

<ol>
<li>cache 时相同的 Key path 文件内容要完全一样，否则不能 cache</li>
<li>deploy 两种方式：<ul>
<li>runner shell Executor: 交叉编译后传到板子上执行</li>
<li>runner ssh Executor: 登录到板子，Mount 服务器执行(板子存储受限，不可重复，慢)</li>
</ul>
</li>
<li><code>sudo su - gitlab-runner</code> ssh board 时要进入 runner 服务器 gitlab-runner 用户</li>
<li>如果想在板子上运行脚本，需要 ssh 执行器<a target="_blank" rel="noopener" href="https://blog.csdn.net/lihao21/article/details/109820904">link</a></li>
<li>ssh 后跟在远端执行的命令</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">script:</span><br><span class="line">    - echo <span class="string">&quot;ssh board......................&quot;</span></span><br><span class="line">    - ssh -o <span class="attribute">StrictHostKeyChecking</span>=<span class="literal">no</span> -o <span class="attribute">UserKnownHostsFile</span>=/dev/null root@10.31.1.170 <span class="string">&quot;whoami&quot;</span></span><br></pre></td></tr></table></figure>

<ol>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section">修改 runner build 位置 builds_dir</a> 配置路径<code>/etc/gitlab-runner/</code>或<code>~/.gitlab-runner/</code></li>
</ol>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/184936276">Gitlab-ci:从零开始的前端自动化部署</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/">GitLab CI&#x2F;CD</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/variables/index.html#enable-debug-logging">Enable Debug logging</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/variables/index.html#list-all-environment-variables">List all environment variables</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/examples/#cicd-templates">CI&#x2F;CD templates</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/ssh_keys/">Using SSH keys with GitLab CI&#x2F;CD</a></li>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000006120164">概念</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gitlab.cn/jh/ci/variables/">gitlab 中文文档</a></li>
<li><a target="_blank" rel="noopener" href="https://gitlab.phigent.io/help/ci/unit_test_reports">test reports</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6847902219837292558">搭建一个使用 GitLab CI 的项目</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/yejingtao703/article/details/83065591">Gitlab-Runner 原理与实现</a></li>
</ol>
<h2 id="samples"><a href="#samples" class="headerlink" title="samples"></a>samples</h2><ol>
<li>gitlab release + jfrog artifactory（如果 docker 有问题，通过 artifacts 传递文件， 在 release 传文件和配置链接）</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">release</span></span><br><span class="line"></span><br><span class="line"><span class="attr">variables:</span></span><br><span class="line">  <span class="attr">TEST_FILE0:</span> <span class="string">&quot;test0-$&#123;PACKAGE_VERSION&#125;-$&#123;CI_COMMIT_TAG&#125;&quot;</span></span><br><span class="line">  <span class="attr">TEST_FILE1:</span> <span class="string">&quot;test1-$&#123;PACKAGE_VERSION&#125;-$&#123;CI_COMMIT_TAG&#125;&quot;</span></span><br><span class="line">  <span class="attr">PACKAGE_VERSION:</span> <span class="string">&quot;1.2.3&quot;</span></span><br><span class="line">  <span class="attr">PACKAGE_REGISTRY_URL:</span> <span class="string">&quot;http://artifacts.xxx.io/artifactory/dcv-cpp&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">default:</span></span><br><span class="line">  <span class="attr">before_script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">JFROG_USER=release</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">JFROG_PASSWD=xxx</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">      push_to_jfrog() &#123;</span></span><br><span class="line"><span class="string">          FILE=$1;</span></span><br><span class="line"><span class="string">          JFROG_PATH=http://artifacts.xxx.io/artifactory/$2;</span></span><br><span class="line"><span class="string">          MD5=$(md5sum $FILE | awk &#x27;&#123;print $1&#125;&#x27;);</span></span><br><span class="line"><span class="string">          curl -u&quot;$&#123;JFROG_USER&#125;:$&#123;JFROG_PASSWD&#125;&quot; -T $FILE -H &quot;X-Checksum-MD5:$&#123;MD5&#125;&quot; -L &quot;$&#123;JFROG_PATH&#125;&quot;;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">hub.xxx.io/avp/cuda11.3.1-trt8.0.3.4-ros2-desktop-ubuntu20.04:v2.0</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">phigent_runner_gpu</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">$CI_COMMIT_TAG</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">mkdir</span> <span class="string">bin</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&quot;$&#123;TEST_FILE0&#125;&quot;</span> <span class="string">&gt;</span> <span class="string">bin/$&#123;TEST_FILE0&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&quot;$&#123;TEST_FILE1&#125;&quot;</span> <span class="string">&gt;</span> <span class="string">bin/$&#123;TEST_FILE1&#125;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">      if [ &quot;$CI_COMMIT_TAG&quot; != &#x27;&#x27; ]; then</span></span><br><span class="line"><span class="string">        push_to_jfrog bin/$&#123;TEST_FILE0&#125; dcv-cpp/$&#123;CI_COMMIT_TAG&#125;/$&#123;TEST_FILE0&#125;</span></span><br><span class="line"><span class="string">        push_to_jfrog bin/$&#123;TEST_FILE1&#125; dcv-cpp/$&#123;CI_COMMIT_TAG&#125;/$&#123;TEST_FILE1&#125;; fi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="attr">release:</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">phigent_runner_gpu</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">release</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">registry.gitlab.com/gitlab-org/release-cli:latest</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">if:</span> <span class="string">$CI_COMMIT_TAG</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">      release-cli create --name &quot;Release $CI_COMMIT_TAG&quot; --tag-name $CI_COMMIT_TAG \</span></span><br><span class="line"><span class="string">        --assets-link &quot;&#123;\&quot;name\&quot;:\&quot;$&#123;TEST_FILE0&#125;\&quot;,\&quot;url\&quot;:\&quot;$&#123;PACKAGE_REGISTRY_URL&#125;/$&#123;CI_COMMIT_TAG&#125;/$&#123;TEST_FILE0&#125;\&quot;&#125;&quot; \</span></span><br><span class="line"><span class="string">        --assets-link &quot;&#123;\&quot;name\&quot;:\&quot;$&#123;TEST_FILE1&#125;\&quot;,\&quot;url\&quot;:\&quot;$&#123;PACKAGE_REGISTRY_URL&#125;/$&#123;CI_COMMIT_TAG&#125;/$&#123;TEST_FILE1&#125;\&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2022/08/19/Jenkins/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/19/Jenkins/" class="post-title-link" itemprop="url">Jenkins</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-19 12:59:26" itemprop="dateCreated datePublished" datetime="2022-08-19T12:59:26+08:00">2022-08-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-20 15:37:37" itemprop="dateModified" datetime="2023-06-20T15:37:37+08:00">2023-06-20</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/08/19/Jenkins/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/08/19/Jenkins/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.jenkins.io/doc/">Doc</a></li>
<li></li>
</ol>
<h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">sudo sh -c <span class="string">&#x27;echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list&#x27;</span></span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">sudo apt-get update</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">sudo apt-get install jenkins</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">sudo vi /etc/default/jenkins <span class="comment">## change port</span></span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">sudo /etc/init.d/jenkins start</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># http://localhost:port</span></span></span><br></pre></td></tr></table></figure>

<h2 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h2><ol>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/ui/search?sort=installed&categories=&labels=&view=List&page=1&query=">插件下载量排名</a></li>
<li>在 Jenkins 界面，系统管理-&gt;管理插件-&gt;安装 SSH Plugin <a target="_blank" rel="noopener" href="https://plugins.jenkins.io/ssh/">ssh</a> <a target="_blank" rel="noopener" href="https://fanlychie.github.io/post/jenkins-remote-ssh.html">link</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/gitlab-plugin/">gitlab-plugin</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/git-parameter/">git parameter</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/build-timeout/">build timeout</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/jobConfigHistory/">jobConfigHistory</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/rebuild/">rebuild</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/material-theme/">material-theme</a> Indigo is good</li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/ansicolor/">ansicolor</a></li>
<li><a target="_blank" rel="noopener" href="https://plugins.jenkins.io/display-console-output/">display-console-output</a></li>
</ol>
<h2 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mingerlcm/p/12728873.html">jenkins 状态反馈给 gitlab</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1599050">gitlab hook</a><ul>
<li>使用 webhook, webhook 与异步编程中”订阅-发布模型”非常类似，一端触发事件，一端监听执行。<br><img src="https://segmentfault.com/img/remote/1460000020249992?w=1000&h=690" alt="数据更新后通过 webhook主动推送"></li>
</ul>
</li>
<li>匿名用户查看权限 Manager Jenkins —&gt; Configure Global Security —&gt; 授权策略</li>
<li>修改记录里有 git commit 历史</li>
<li>可以看工作空间</li>
<li>log rotation Job Configuration –&gt;Discard Old Builds:(丢弃旧的构建), job 描述正下方</li>
<li>Add timestamps to the Console Output</li>
<li>归档时记录所有归档成品的指纹</li>
<li>工作区 job 目录下的 config.xml 文件比较重要，可以 git 管理起来，能恢复配置</li>
<li>下载.war 包 <a target="_blank" rel="noopener" href="https://jenkins.io/download/">https://jenkins.io/download/</a></li>
<li>使用命令： java -jar jenkins.war</li>
<li>参考文档： <a target="_blank" rel="noopener" href="https://jenkins.io/doc/book/">https://jenkins.io/doc/book/</a></li>
<li>远程部署：安装插件 <a target="_blank" rel="noopener" href="https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+FTP+Plugin">Publish Over FTP Plugin</a> publish over ssh FTP 用于传文件 SSH 用于在远程机器上执行命令</li>
<li>定时构建： <a target="_blank" rel="noopener" href="https://www.cnblogs.com/caoj/p/7815820.html">https://www.cnblogs.com/caoj/p/7815820.html</a></li>
<li>存档： <a target="_blank" rel="noopener" href="https://blog.csdn.net/liqiangeastsun/article/details/79062806">https://blog.csdn.net/liqiangeastsun/article/details/79062806</a> 文件位置 : .&#x2F;jobs&#x2F;test&#x2F;builds&#x2F;57&#x2F;archive ， deephi*</li>
<li>文件命名：日期 + git 号 。gitnum&#x3D;<code>git log --pretty=oneline -1 | cut -b 1-8</code> date<em>temp&#x3D;<code>date +%m%d</code> mv app.c app</em>${date_temp}_${gitnum}.c</li>
<li>文件 md5 值： <a target="_blank" rel="noopener" href="http://ju.outofmemory.cn/entry/117335">http://ju.outofmemory.cn/entry/117335</a></li>
<li>邮箱：管理员地址 <a target="_blank" rel="noopener" href="https://blog.csdn.net/songjiaping/article/details/51496977">https://blog.csdn.net/songjiaping/article/details/51496977</a> 126 开启 smtp <a target="_blank" rel="noopener" href="https://www.cnblogs.com/yangxia-test/p/4366172.html">https://www.cnblogs.com/yangxia-test/p/4366172.html</a> <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2afb099f2a79">https://www.jianshu.com/p/2afb099f2a79</a> <a target="_blank" rel="noopener" href="http://skyfar666.iteye.com/blog/1973434">http://skyfar666.iteye.com/blog/1973434</a></li>
<li>本地文件管理，源码管理不用 git 仓库，选择 none。就能在其他目录下工作，可以把要保留的文件传回到工作区，保存。</li>
<li>如何获取远程机器的 log?</li>
<li>Timestamper 控制台输出显示</li>
<li>Workspace Cleanup Plugin</li>
<li>blue ocean 插件</li>
<li>增加项目描述 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/chongyou/p/7365351.html">https://www.cnblogs.com/chongyou/p/7365351.html</a></li>
<li>配置变更记录 <a target="_blank" rel="noopener" href="https://blog.csdn.net/j3T9Z7H/article/details/78422565">https://blog.csdn.net/j3T9Z7H/article/details/78422565</a></li>
<li>配置</li>
</ol>
<h2 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h2><ol>
<li>jenkins ssh 登录找不到 cmake, 因为 jenkins 会从&#x2F;usr&#x2F;bin 下找，和登录环境不一样。解决办法：修改客户端 ssh 配置，允许 PermitUserEnvironment <a target="_blank" rel="noopener" href="https://docs.cloudbees.com/docs/cloudbees-ci-kb/latest/client-and-managed-masters/how-to-set-up-a-jenkins-agent-to-have-the-same-path-as-the-user-when-connected-via-remote-desktop">link</a></li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2020/12/07/Tmux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/07/Tmux/" class="post-title-link" itemprop="url">Tmux config</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-07 15:19:28" itemprop="dateCreated datePublished" datetime="2020-12-07T15:19:28+08:00">2020-12-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-20 15:37:37" itemprop="dateModified" datetime="2023-06-20T15:37:37+08:00">2023-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/Tmux/" itemprop="url" rel="index"><span itemprop="name">Tmux</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/12/07/Tmux/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/12/07/Tmux/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tmux-plugin"><a href="#tmux-plugin" class="headerlink" title="tmux plugin"></a>tmux plugin</h2><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/tmux-plugins/tpm">tpm</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/orgs/tmux-plugins/repositories?q=&type=all&language=&sort=stargazers">tmux-plgins</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/tmux-plugins/tmux-resurrect">tmux-resurrect</a></li>
<li>prefix + I install</li>
</ol>
<h2 id="clear-history"><a href="#clear-history" class="headerlink" title="clear-history"></a>clear-history</h2><ol>
<li>Just type<code>&lt;prefix&gt; + :</code>in the relevant pane and then type <code>clear-history</code> and press enter.</li>
</ol>
<h2 id="windows-layerout"><a href="#windows-layerout" class="headerlink" title="windows layerout"></a>windows layerout</h2><ol>
<li><code>&lt;prefix&gt; + M-1</code> 垂直对齐</li>
<li><code>&lt;prefix&gt; + M-2</code> 水平对齐</li>
<li><code>&lt;prefix&gt; + M-3</code></li>
<li><code>&lt;prefix&gt; + M-4</code></li>
<li><code>&lt;prefix&gt; + M-5</code></li>
</ol>
<h2 id="resize-window"><a href="#resize-window" class="headerlink" title="resize window"></a>resize window</h2><ol>
<li>:resize-window -A</li>
</ol>
<h2 id="Tmux-config"><a href="#Tmux-config" class="headerlink" title="Tmux config"></a>Tmux config</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use mouse to scroll <span class="built_in">history</span></span></span><br><span class="line">set -g mouse on        #For tmux version 2.1 and up</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> -g mode-mouse on   <span class="comment">#For tmux versions &lt; 2.1</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> <span class="built_in">history</span> lenth</span></span><br><span class="line">set -g history-limit 15000</span><br><span class="line"></span><br><span class="line">set -g default-terminal &quot;xterm&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">change prefix key</span></span><br><span class="line">set -g prefix C-t</span><br><span class="line">unbind C-b</span><br><span class="line">bind C-t send-prefix</span><br><span class="line">set -g prefix2 C-j</span><br><span class="line">bind C-j send-prefix -2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">more intuitive keybindings <span class="keyword">for</span> splitting and create window</span></span><br><span class="line">bind \\ split-window -h -c &quot;#&#123;pane_current_path&#125;&quot;</span><br><span class="line">bind - split-window -v -c &quot;#&#123;pane_current_path&#125;&quot;</span><br><span class="line">bind c new-window -c &quot;#&#123;pane_current_path&#125;&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">swap window <span class="built_in">bind</span></span></span><br><span class="line">bind M-l swap-window -t + \; next-window</span><br><span class="line">bind M-h swap-window -t - \; previous-window</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">display</span></span><br><span class="line">set -g base-index 1</span><br><span class="line">set-window-option -g pane-base-index 1</span><br><span class="line">set -g renumber-windows on</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> terminal title</span></span><br><span class="line">set -g set-titles on</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">redraw status line every 10 seconds</span></span><br><span class="line">set -g status-interval 10</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">right status: tmux show-options -g | grep status-right</span></span><br><span class="line">set -g status-right &quot;#&#123;=21:host_short&#125; &quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Remove delay when sending commands</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(default is 500 milliseconds)</span></span><br><span class="line">set -sg escape-time 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">reference C-t ?</span></span><br><span class="line">bind-key -T prefix a select-window -t :=1</span><br><span class="line">bind-key -T prefix s select-window -t :=2</span><br><span class="line">bind-key -T prefix d select-window -t :=3</span><br><span class="line">bind-key -T prefix f select-window -t :=4</span><br><span class="line">bind-key -T prefix g select-window -t :=5</span><br><span class="line">bind-key -T prefix h select-window -t :=6</span><br><span class="line">bind-key -T prefix j select-window -t :=7</span><br><span class="line">bind-key -T prefix k select-window -t :=8</span><br><span class="line">bind-key -T prefix \; select-window -t :=1 \; select-window -t -1</span><br></pre></td></tr></table></figure>

<h2 id="Reload-config"><a href="#Reload-config" class="headerlink" title="Reload config"></a>Reload config</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux source-file ~/.tmux.conf</span><br></pre></td></tr></table></figure>

<h2 id="Tmux-Zsh-CheatSheet"><a href="#Tmux-Zsh-CheatSheet" class="headerlink" title="Tmux Zsh CheatSheet"></a>Tmux Zsh CheatSheet</h2><p><a target="_blank" rel="noopener" href="https://github.com/ohmyzsh/ohmyzsh/wiki/Cheatsheet">https://github.com/ohmyzsh/ohmyzsh/wiki/Cheatsheet</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ta    : tmux attach -t</span><br><span class="line">tad   : tmux attach -d -t</span><br><span class="line">ts    : tmux new-session -s</span><br><span class="line">tl    : tmux list-sessions</span><br><span class="line">tksv  : tmux kill-server</span><br><span class="line">tkss  : tmux kill-session -t</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiaxiyang.github.io/2023/09/21/test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/coder2.jpg">
      <meta itemprop="name" content="贾夕阳">
      <meta itemprop="description" content="深度学习/自动驾驶/C++/性能优化">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiyang">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/21/test/" class="post-title-link" itemprop="url">test</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-21 16:05:15" itemprop="dateCreated datePublished" datetime="2023-09-21T16:05:15+08:00">2023-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-24 11:26:42" itemprop="dateModified" datetime="2023-09-24T11:26:42+08:00">2023-09-24</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2023/09/21/test/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2023/09/21/test/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="gitlab-testing"><a href="#gitlab-testing" class="headerlink" title="gitlab testing"></a><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/ci/testing/">gitlab testing</a></h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/09/21/test/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="贾夕阳"
      src="/images/coder2.jpg">
  <p class="site-author-name" itemprop="name">贾夕阳</p>
  <div class="site-description" itemprop="description">深度学习/自动驾驶/C++/性能优化</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">147</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">37</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jiaxiyang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jiaxiyang" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



  <div class="links-of-recent-posts motion-element">
    <div class="links-of-recent-posts-title">
      <i class="fa fa-history fa-fw"></i>
      最近文章
    </div>
    <ul class="links-of-recent-posts-list">
        <li class="links-of-recent-posts-item">
          <a href="/2023/09/21/test/" title="2023&#x2F;09&#x2F;21&#x2F;test&#x2F;">test</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/2023/09/21/assembly/" title="2023&#x2F;09&#x2F;21&#x2F;assembly&#x2F;">assembly</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/2023/09/20/QEMU/" title="2023&#x2F;09&#x2F;20&#x2F;QEMU&#x2F;">QEMU</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/2023/09/13/Reverse-Engineering/" title="2023&#x2F;09&#x2F;13&#x2F;Reverse-Engineering&#x2F;">Reverse-Engineering</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/2023/09/04/go/" title="2023&#x2F;09&#x2F;04&#x2F;go&#x2F;">go</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">贾夕阳</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">347k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">5:16</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'dark',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://jiaxiyang.github.io/page/2/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'hbdf2zNhxCCzlSuodiOKirnE-gzGzoHsz',
      appKey     : 'gJuRc9Mu4JIB0czCtRefSodC',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
